define(["require","fabric","./asBrush"],function(t){function i(t,i,n){for(var e,r,s,o=[],h=i/2,c=0;c<n.density;c++)e=a.util.getRandomInt(t.x-h,t.x+h),r=a.util.getRandomInt(t.y-h,t.y+h),s=n.dotWidthVariance?a.util.getRandomInt(Math.max(1,n.dotWidth-n.dotWidthVariance),n.dotWidth+n.dotWidthVariance):n.dotWidth,o.push({x:e,y:r,width:s});return o}function n(t,i){this.initialize(t,i)}var a=t("fabric"),e=(a.util.getRandomInt,t("./asBrush"));return n.prototype.initBrush=function(){this.brush=new a.SprayBrush(this.canvas)},n.prototype.drawAtPoints=function(t){var n=this.canvas.renderOnAddition;this.canvas.renderOnAddition=!1;for(var e,r=[],s=0,o=t.length;o>s;s++){e=i(t[s],this.cfg.width,this.brush);for(var h=0,c=e.length;c>h;h++)r.push(new a.Rect({width:e[h].width,height:e[h].width,left:e[h].x+1,top:e[h].y+1,fill:this.cfg.fillColor}))}this.optimizeOverlapping&&(r=this._getOptimizedRects(r));var u=new a.Group(r);this.canvas.add(u),this.canvas.fire("path:created",{path:u}),this.canvas.clearContext(this.canvas.contextTop),this.canvas.renderOnAddition=n,this.canvas.renderAll()},e.call(n.prototype),n});