define(["require","fabric","./asBrush"],function(t){function i(t,i,n){for(var r,a,h,s=[],o=i/2,d=0;d<n.density;d++)r=e.util.getRandomInt(t.x-o,t.x+o),a=e.util.getRandomInt(t.y-o,t.y+o),h=n.dotWidthVariance?e.util.getRandomInt(Math.max(1,n.dotWidth-n.dotWidthVariance),n.dotWidth+n.dotWidthVariance):n.dotWidth,s.push({x:r,y:a,width:h});return s}function n(t,i){this.initialize(t,i)}var e=t("fabric"),r=(e.util.getRandomInt,t("./asBrush"));return n.prototype.initBrush=function(){this.brush=new e.SprayBrush(this.canvas),this.brush.density=10},n.prototype.drawOne=function(t){return new e.Rect({width:t.width,height:t.width,left:t.x+1,top:t.y+1,fill:this.cfg.fillColor})},n.prototype.drawAtPoints=function(t){var n=this.canvas.renderOnAddition;this.canvas.renderOnAddition=!1;for(var e,r=[],a=0,h=t.length;h>a;a++){e=i(t[a],this.cfg.width,this.brush);for(var s=0,o=e.length;o>s;s++)r.push(this.drawOne(e[s]))}this.optimizeOverlapping&&(r=this._getOptimizedRects(r)),this.processObjects(r),this.canvas.clearContext(this.canvas.contextTop),this.canvas.renderOnAddition=n,this.canvas.renderAll()},r.call(n.prototype),n});