define(["require","fabric","extBrushes/fabric.RectBrush"],function(t){var e=t("fabric"),i=t("extBrushes/fabric.RectBrush"),n=e.util.getRandomInt,r=e.util.createClass(i,{addPoint:function(t){var i=new e.Point(t.x,t.y),r=n(0,this.width),o=new e.Color(this.color).setAlpha(n(0,100)/100).toRgba();return i.width=i.height=r,i.strokeColor=o,this.points.push(i),i},drawRect:function(t){var e=this.addPoint(t),i=this.canvas.contextTop;i.lineWidth=1,i.strokeStyle=e.strokeColor,i.beginPath(),i.strokeRect(e.x-e.width/2,e.y-e.height/2,e.width,e.height),i.stroke()},onMouseUp:function(){var t=this.canvas.renderOnAddition;this.canvas.renderOnAddition=!1;for(var i=[],n=0,r=this.points.length;r>n;n++){var o=this.points[n];i.push(new e.Rect({width:o.width,height:o.height,left:o.x,top:o.y,originX:"center",originY:"center",fill:null,stroke:o.strokeColor,strokeWidth:1}))}var s=new e.Group(i,{originX:"center",originY:"center"});this.canvas.add(s),this.canvas.fire("path:created",{path:s}),this.canvas.clearContext(this.canvas.contextTop),this.canvas.renderOnAddition=t,this.canvas.renderAll()}});return r});