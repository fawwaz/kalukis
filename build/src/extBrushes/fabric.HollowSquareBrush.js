define(["require","fabric","extBrushes/fabric.RectBrush"],function(t){var e=t("fabric"),i=t("extBrushes/fabric.RectBrush"),r=e.util.getRandomInt,n=e.util.createClass(i,{addPoint:function(t){var i=new e.Point(t.x,t.y),n=r(0,this.width),s=new e.Color(this.color).setAlpha(r(0,100)/100).toRgba();return i.width=i.height=n,i.strokeColor=s,this.points.push(i),i},drawRect:function(t){var e=this.addPoint(t),i=this.canvas.contextTop;i.lineWidth=1,i.strokeStyle=e.strokeColor,i.beginPath(),i.strokeRect(e.x-e.width/2,e.y-e.height/2,e.width,e.height),i.stroke()},onMouseUp:function(){var t=this.canvas.renderOnAddition;this.canvas.renderOnAddition=!1;for(var i=[],r=0,n=this.points.length;n>r;r++){var s=this.points[r];i.push(new e.Rect({width:s.width,height:s.height,left:s.x,top:s.y,fill:null,stroke:s.strokeColor,strokeWidth:1}))}var o=new e.Group(i);this.canvas.add(o),this.canvas.fire("path:created",{path:o}),this.canvas.clearContext(this.canvas.contextTop),this.canvas.renderOnAddition=t,this.canvas.renderAll()}});return n});