define(["require","fabric"],function(t){var i=t("fabric"),n=i.util.getRandomInt,e=i.util.createClass(i.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawRect:function(t){var i=this.addPoint(t),n=this.canvas.contextTop;n.fillStyle=i.fill,n.fillRect(i.x-i.width/2,i.y-i.height/2,i.width,i.height)},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this.drawRect(t)},onMouseMove:function(t){this.drawRect(t)},onMouseUp:function(){var t=this.canvas.renderOnAddition;this.canvas.renderOnAddition=!1;for(var n=[],e=0,a=this.points.length;a>e;e++){var s=this.points[e];n.push(new i.Rect({width:s.width,height:s.height,top:s.y,left:s.x,originX:"center",originY:"center",fill:s.fill}))}var o=new i.Group(n,{originX:"center",originY:"center"});this.canvas.add(o),this.canvas.fire("path:created",{path:o}),this.canvas.clearContext(this.canvas.contextTop),this.canvas.renderOnAddition=t,this.canvas.renderAll()},addPoint:function(t){var e=new i.Point(t.x,t.y),a=n(0,this.width),s=new i.Color(this.color).setAlpha(i.util.getRandomInt(0,100)/100).toRgba();return e.width=e.height=a,e.fill=s,this.points.push(e),e}});return e});