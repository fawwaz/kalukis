define(["require","fabric"],function(t){var e=t("fabric"),i=e.util.getRandomInt,r=e.util.createClass(e.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawRect:function(t){var e=this.addPoint(t),i=this.canvas.contextTop;i.fillStyle=e.fill,i.fillRect(e.x-e.width/2,e.y-e.height/2,e.width,e.height)},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this.drawRect(t)},onMouseMove:function(t){this.drawRect(t)},onMouseUp:function(){var t=this.canvas.renderOnAddition;this.canvas.renderOnAddition=!1;for(var i=[],r=0,n=this.points.length;n>r;r++){var s=this.points[r];i.push(new e.Rect({width:s.width,height:s.height,top:s.y,left:s.x,fill:s.fill}))}var o=new e.Group(i);this.canvas.add(o),this.canvas.fire("path:created",{path:o}),this.canvas.clearContext(this.canvas.contextTop),this.canvas.renderOnAddition=t,this.canvas.renderAll()},addPoint:function(t){var r=new e.Point(t.x,t.y),n=i(0,this.width),s=new e.Color(this.color).setAlpha(e.util.getRandomInt(0,100)/100).toRgba();return r.width=r.height=n,r.fill=s,this.points.push(r),r}});return r});