define(["require","fabric","extBrushes/fabric.BrushDistance","extBrushes/fabric.BrushSensitivity"],function(i){function t(){var i,t;this.after("initialize",function(){this.on("brush-served",function(i,t){this.setBrush(t.brush)}.bind(this)),this.on("brushProperty-updated",function(i,t){"width"===t.key?this.setBrushWidth(t.newValue):"fillColor"===t.key||"strokeColor"===t.key?this.setBrushColor(t.newValue):"distance"===t.key?this.setBrushDistance(t.newValue):"sensitivity"===t.key&&this.setSensitivity(t.newValue)}.bind(this))}),this.startFreehandPainting=function(e,s){var n=s||t;n&&(i=e,i.isDrawingMode=!0,this.setupFreehandPaintingProperty(n))},this.setupFreehandPaintingProperty=function(t){var n=t.getBrush();n.color=t.get("fillColor"),n.width=t.get("width"),i.freeDrawingBrush=n,e.hijack(n),s.hijack(n)},this.stopFreehandPainting=function(){i&&(i.isDrawingMode=!1)},this.setBrush=function(e){t=e,i&&i.isDrawingMode&&this.setupFreehandPaintingProperty(e)},this.getBrush=function(){return t},this.setBrushWidth=function(e){t.set("width",e),i&&i.isDrawingMode&&(i.freeDrawingBrush.width=e)},this.setBrushColor=function(e){t.set("fillColor",e),i&&i.isDrawingMode&&(i.freeDrawingBrush.color=e)},this.setBrushDistance=function(i){e.setDistance(i)},this.setSensitivity=function(i){s.setSensitivity(i)},this.setFreehandCanvas=function(t){i=t},this.getFreehandCanvas=function(){return i}}var e=(i("fabric"),i("extBrushes/fabric.BrushDistance")),s=i("extBrushes/fabric.BrushSensitivity");return t});