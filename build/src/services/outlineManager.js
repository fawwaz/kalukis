define(["require","flight/lib/component"],function(t){function e(){this.defaultAttrs({canvasId:void 0,canvas:void 0,outlineShapes:{},prop:{width:10,fillColor:"#000000",strokeColor:"#000000"}}),this.after("initialize",function(){this.attachEventListener(),this.requestCanvas()}),this.attachEventListener=function(){this.on("canvas-served",function(t,e){this.setCanvas(e.id,e.canvas)}.bind(this)),this.on("request-outlineShape",function(t,e){this.requestOutlineShape(e.id)}.bind(this)),this.on("brushProperty-updated",this.updateOutlineProperties)},this.requestCanvas=function(){this.trigger("request-canvas")},this.setCanvas=function(t,e){this.attr.canvasId=t,this.attr.canvas=e},this.requestOutlineShape=function(e){if(e+="Outline",this.attr.outlineShapes.hasOwnProperty(e)){var i=this.attr.outlineShapes[e];this.setOutlineShapeProperties(i),this.publishOutlineShape(i)}else t(["outlineShapes/"+e],function(t){var i=new t(this.attr.canvas,this.attr.prop);this.attr.outlineShapes[e]=i,this.publishOutlineShape(i)}.bind(this))},this.publishOutlineShape=function(t){this.trigger("outlineShape-served",{outlineShape:t})},this.updateOutlineProperties=function(t,e){if(e.hasOwnProperty("key")&&e.hasOwnProperty("newValue")){var i=this.attr.prop[e.key];this.attr.prop[e.key]=e.newValue,this.trigger("outlineShapeProperty-updated",{key:e.key,oldValue:i,newValue:e.newValue})}},this.setOutlineShapeProperties=function(t){Object.keys(this.attr.prop||{}).forEach(function(e){t.set(e,this.attr.prop[e])},this)}}var i=t("flight/lib/component");return i(e)});